SELECT corp_cd MPA, hkc_dcd HK, RTRIM(ptno) PNO, RTRIM(hkc_dcd||ptno) HKPNO, RTRIM(pt_nm) PNAME,cha_cd CHR_CD, suc_cd SUC, sd_cls_cd CLS,      

EIM.PKG_CMP, EIM.STORING, EIM.AVAILABLE, PVN.VND1, VEN.VND_NM_E, VEN.VND_NM_K, SEAIP.SEA_ALC_QT, SEAIP.SEA_PICK_QT, SEAIP.SEA_PACK_QT, SEAIP.SEA_PACKED_QT,

AIRIP.AIR_ALC_QT, AIRIP.AIR_PICK_QT, AIRIP.AIR_PACK_QT, AIRIP.AIR_PACKED_QT, SEAIP.SEA_INVOICE_QT, AIRIP.AIR_INVOICE_QT, SEAIP.BO_SEA, AIRIP.BO_AIR

FROM XXXX.GPMS      



LEFT OUTER JOIN (SELECT hkc_dcd HK, RTRIM(ptno) PNO, SUM(raw_stk_qty) PKG_CMP, SUM(gnrl_str_stby_qty) STORING, SUM(gnrl_gds_stk_qty) AVAILABLE

                FROM NDWADM.MEIM      

                GROUP BY hkc_dcd, RTRIM(ptno)) AS EIM      

                ON hkc_dcd = EIM.HK AND RTRIM(ptno) = EIM.PNO      



LEFT OUTER JOIN (SELECT hkc_dcd HK, RTRIM(ptno) PNO, pt_wth LENGTH, pt_vtcl WIDE, pt_hgt HEIGHT, pt_wgt WEIGHT      

                FROM XXXX.MEPM

                GROUP BY hkc_dcd, RTRIM(ptno), pt_wth, pt_vtcl, pt_hgt, pt_wgt) AS EPM      

                ON hkc_dcd = EPM.HK AND RTRIM(ptno) = EPM.PNO   

                

LEFT OUTER JOIN(SELECT hkc_dcd HK, RTRIM(ptno) PNO, vnd_cd VND1

                FROM XXXX.MPVN

                WHERE de_dcd= 'E' AND po_rat=1) AS PVN

                ON hkc_dcd=PVN.HK AND RTRIM(ptno)=PVN.PNO



LEFT OUTER JOIN (SELECT vnd_cd VND2, vnd_eng_nm VND_NM_E, vnd_nm VND_NM_K 

                FROM XXXX.MVEN      

                GROUP BY vnd_cd, vnd_eng_nm, vnd_nm) AS VEN      

                ON PVN.VND1 = VEN.VND2   



LEFT OUTER JOIN (SELECT RTRIM(hkc_dcd) HK, RTRIM(conf_ptno) PNO, SUM(ord_allo_qty) SEA_ALC_QT, SUM(opic_qty) SEA_PICK_QT,

                 SUM(opac_qty) SEA_PACK_QT,  SUM(pac_qty) SEA_PACKED_QT, SUM(inv_qty) SEA_INVOICE_QT, SUM(lst_bo_qty) BO_SEA      

                FROM XXXX.MORP    

                WHERE dst_sccd IN ('MPA') AND odf_cd NOT IN ('C','X','D')

                AND (lst_bo_qty>0 OR ord_allo_qty>0 OR opic_qty>0 OR opac_qty>0 OR pac_qty>0 OR inv_qty>0) AND spy_cd = 'SEA'

                GROUP BY RTRIM(hkc_dcd), RTRIM(conf_ptno)) AS SEAIP

                ON hkc_dcd = SEAIP.HK AND RTRIM(ptno) = SEAIP.PNO  



LEFT OUTER JOIN (SELECT RTRIM(hkc_dcd) HK, RTRIM(conf_ptno) PNO, SUM(ord_allo_qty) AIR_ALC_QT, SUM(opic_qty) AIR_PICK_QT,

                SUM(opac_qty) AIR_PACK_QT, SUM(pac_qty) AIR_PACKED_QT, SUM(inv_qty) AIR_INVOICE_QT,SUM(lst_bo_qty) BO_AIR                 

                FROM XXXX.MORP       

                WHERE dst_sccd IN ('MPA') AND odf_cd NOT IN ('C','X','D')    

                AND (lst_bo_qty>0 OR ord_allo_qty>0 OR opic_qty>0 OR opac_qty>0 OR pac_qty>0 OR inv_qty>0) AND spy_cd IN ('AIR','VOR','VXR')

                GROUP BY RTRIM(hkc_dcd), RTRIM(conf_ptno)) AS AIRIP

                ON hkc_dcd = AIRIP.HK AND RTRIM(ptno) = AIRIP.PNO                     



WHERE corp_cd IN ('MPA') AND vnd_cd IN ('M00H','M00K') AND (LEFT(sd_cls_cd,1) IN ('A','B','E','C')) 

AND (EIM.PKG_CMP > 0 OR EIM.STORING > 0 OR EIM.AVAILABLE > 0 OR SEAIP.SEA_PACKED_QT > 0 OR SEAIP.SEA_ALC_QT > 0 OR SEAIP.SEA_PICK_QT > 0 OR SEAIP.SEA_PACK_QT > 0 OR AIRIP.AIR_PACKED_QT > 0 OR AIRIP.AIR_ALC_QT > 0 OR AIRIP.AIR_PICK_QT > 0 OR AIRIP.AIR_PACK_QT > 0 or SEAIP.BO_SEA>0 OR AIRIP.BO_AIR>0 or SEAIP.SEA_INVOICE_QT>0 OR AIRIP.AIR_INVOICE_QT>0)       



GROUP BY corp_cd, hkc_dcd, RTRIM(ptno), RTRIM(hkc_dcd||ptno), RTRIM(pt_nm), vnd_cd, aply_dt, bout_dt, fob_amt, cha_cd, suc_cd, sd_cls_cd, 

VEN.VND_NM_E, VEN.VND_NM_K, EPM.LENGTH, EPM.WIDE, EPM.HEIGHT, EPM.WEIGHT,EIM.PKG_CMP, EIM.STORING, EIM.AVAILABLE, PVN.VND1, SEAIP.SEA_ALC_QT, 

SEAIP.SEA_PICK_QT, SEAIP.SEA_PACK_QT, SEAIP.SEA_PACKED_QT,AIRIP.AIR_ALC_QT, AIRIP.AIR_PICK_QT, AIRIP.AIR_PACK_QT, AIRIP.AIR_PACKED_QT, 

SEAIP.SEA_INVOICE_QT, AIRIP.AIR_INVOICE_QT, SEAIP.BO_SEA, AIRIP.BO_AIR
